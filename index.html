<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Sarabun', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #e0f2fe 0%, #f1f8e9 100%); }
        .card-shadow { box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); }
        .btn-primary { background: linear-gradient(135deg, #00bcd4 0%, #26c6da 100%); }
        .btn-primary:hover { background: linear-gradient(135deg, #0097a7 0%, #00acc1 100%); }
        .status-available { background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%); }
        .status-booked { background: linear-gradient(135deg, #f44336 0%, #ef5350 100%); }
        .calendar-day { transition: all 0.3s ease; }
        .calendar-day:hover { transform: translateY(-2px); }
        .calendar-day.selected { background: linear-gradient(135deg, #00bcd4 0%, #26c6da 100%); color: white; }
        .calendar-day.has-booking { background: linear-gradient(135deg, #ff9800 0%, #ffb74d 100%); color: white; }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">üè¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</h1>
            <p class="text-lg text-gray-600">Smart Meeting Room Booking System</p>
        </div>

        <!-- Navigation -->
        <div class="flex flex-wrap justify-center gap-4 mb-8">
            <button onclick="showPage('booking')" class="btn-primary text-white px-6 py-3 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                üìÖ ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
            </button>
            <button onclick="showPage('myBookings')" class="btn-primary text-white px-6 py-3 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô
            </button>
            <button onclick="showPage('calendar')" class="btn-primary text-white px-6 py-3 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                üìÜ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
            </button>
            <button onclick="showPage('statistics')" class="btn-primary text-white px-6 py-3 rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            </button>
        </div>

        <!-- Booking Page -->
        <div id="bookingPage" class="page">
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Date Selection -->
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">üìÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</h2>
                    <div id="calendar" class="grid grid-cols-7 gap-2 mb-4">
                        <!-- Calendar will be generated here -->
                    </div>
                    <div class="text-center">
                        <button onclick="previousMonth()" class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg mr-2">‚Üê ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô</button>
                        <span id="currentMonth" class="font-semibold text-lg mx-4"></span>
                        <button onclick="nextMonth()" class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg ml-2">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
                    </div>
                </div>

                <!-- Time Selection -->
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4">‚è∞ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                            <select id="startTime" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                                <!-- Time options will be generated -->
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
                            <select id="endTime" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                                <!-- Time options will be generated -->
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Room Selection -->
            <div class="bg-white rounded-xl p-6 card-shadow mt-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">üèõÔ∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h2>
                <div id="roomList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Rooms will be generated here -->
                </div>
            </div>
        </div>

        <!-- Booking Form Modal -->
        <div id="bookingModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 card-shadow">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6">üìù ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h3>
                <form id="bookingForm" onsubmit="submitBooking(event)">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</label>
                        <input id="selectedRoom" type="text" readonly class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤</label>
                        <input id="selectedDateTime" type="text" readonly class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                        <input id="department" type="text" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</label>
                        <textarea id="purpose" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent" rows="3"></textarea>
                    </div>
                    <div class="flex gap-4">
                        <button type="submit" class="flex-1 btn-primary text-white py-3 rounded-lg font-medium hover:shadow-lg transition-all duration-300">
                            ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
                        </button>
                        <button type="button" onclick="closeBookingModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg font-medium transition-all duration-300">
                            ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- My Bookings Page -->
        <div id="myBookingsPage" class="page hidden">
            <div class="bg-white rounded-xl p-6 card-shadow">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h2>
                
                <!-- Filters -->
                <div class="grid md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á</label>
                        <select id="roomFilter" onchange="filterMyBookings()" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                            <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                        <input id="dateFilter" type="date" onchange="filterMyBookings()" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                    </div>
                </div>

                <div id="myBookingsList">
                    <!-- My bookings will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Calendar Page -->
        <div id="calendarPage" class="page hidden">
            <div class="bg-white rounded-xl p-6 card-shadow">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">üìÜ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                <div class="text-center mb-6">
                    <button onclick="previousCalendarMonth()" class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg mr-2">‚Üê ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô</button>
                    <span id="calendarCurrentMonth" class="font-semibold text-xl mx-4"></span>
                    <button onclick="nextCalendarMonth()" class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg ml-2">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
                </div>
                <div id="fullCalendar" class="grid grid-cols-7 gap-2">
                    <!-- Full calendar will be generated here -->
                </div>
            </div>
        </div>

        <!-- Statistics Page -->
        <div id="statisticsPage" class="page hidden">
            <div class="grid lg:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
                    <div id="statisticsContent">
                        <!-- Statistics will be displayed here -->
                    </div>
                </div>
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">üìà ‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
                    <div id="chartContent">
                        <!-- Chart will be displayed here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Cancel Booking Modal -->
        <div id="cancelModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 card-shadow">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6">üîê ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h3>
                <p class="text-gray-600 mb-4">‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£</p>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™</label>
                    <input id="cancelCode" type="password" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ 1234" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                </div>
                <div class="flex gap-4">
                    <button onclick="confirmCancel()" class="flex-1 bg-red-500 hover:bg-red-600 text-white py-3 rounded-lg font-medium transition-all duration-300">
                        ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button onclick="closeCancelModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg font-medium transition-all duration-300">
                        ‚ùå ‡∏õ‡∏¥‡∏î
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentDate = new Date();
        let selectedDate = new Date();
        let calendarDate = new Date();
        let bookings = JSON.parse(localStorage.getItem('meetingBookings')) || [];
        let currentBookingToCancel = null;

        // Room data
        const rooms = [
            { id: 'usr', name: '‡∏´‡πâ‡∏≠‡∏áUSR(1-101)', capacity: 70, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 1 ‡∏ä‡∏±‡πâ‡∏ô 1' },
            { id: 'seminar', name: '‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤', capacity: 80, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 3 ‡∏ä‡∏±‡πâ‡∏ô 1' },
            { id: 'pukya1', name: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏û‡∏∏‡∏Ñ‡∏¢‡∏≤‡∏†‡∏£‡∏ì‡πå 1', capacity: 360, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 3 ‡∏ä‡∏±‡πâ‡∏ô 1' },
            { id: 'pukya2', name: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏û‡∏∏‡∏Ñ‡∏¢‡∏≤‡∏†‡∏£‡∏ì‡πå 2 (3-206)', capacity: 120, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 3 ‡∏ä‡∏±‡πâ‡∏ô 2' },
            { id: 'executive', name: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ 3-202', capacity: 40, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 3 ‡∏ä‡∏±‡πâ‡∏ô 2' }
        ];

        // Time slots
        function generateTimeSlots() {
            const slots = [];
            for (let hour = 9; hour <= 20; hour++) {
                for (let minute = 0; minute < 60; minute += 30) {
                    if (hour === 20 && minute > 30) break;
                    const timeStr = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    slots.push(timeStr);
                }
            }
            return slots;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeTimeSlots();
            generateCalendar();
            generateRoomList();
            updateMyBookings();
            updateStatistics();
            populateRoomFilter();
            
            // Set default selected date to today
            selectedDate = new Date();
            updateRoomAvailability();
        });

        function initializeTimeSlots() {
            const startTimeSelect = document.getElementById('startTime');
            const endTimeSelect = document.getElementById('endTime');
            const timeSlots = generateTimeSlots();

            timeSlots.forEach(time => {
                const option1 = new Option(time, time);
                const option2 = new Option(time, time);
                startTimeSelect.add(option1);
                endTimeSelect.add(option2);
            });

            // Set default end time to 1 hour after start time
            startTimeSelect.addEventListener('change', function() {
                const startIndex = timeSlots.indexOf(this.value);
                if (startIndex >= 0 && startIndex < timeSlots.length - 1) {
                    endTimeSelect.value = timeSlots[startIndex + 2] || timeSlots[timeSlots.length - 1];
                }
                updateRoomAvailability();
            });

            endTimeSelect.addEventListener('change', updateRoomAvailability);
        }

        function generateCalendar() {
            const calendar = document.getElementById('calendar');
            const monthNames = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                              '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];
            const dayNames = ['‡∏≠‡∏≤', '‡∏à', '‡∏≠', '‡∏û', '‡∏û‡∏§', '‡∏®', '‡∏™'];

            document.getElementById('currentMonth').textContent = 
                `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear() + 543}`;

            calendar.innerHTML = '';

            // Add day headers
            dayNames.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'text-center font-semibold text-gray-600 py-2';
                dayHeader.textContent = day;
                calendar.appendChild(dayHeader);
            });

            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);

                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day text-center p-3 rounded-lg cursor-pointer border';
                
                if (date.getMonth() !== currentDate.getMonth()) {
                    dayElement.className += ' text-gray-400 bg-gray-50';
                } else {
                    dayElement.className += ' text-gray-800 bg-white hover:bg-cyan-50';
                }

                if (date.toDateString() === new Date().toDateString()) {
                    dayElement.className += ' ring-2 ring-cyan-400';
                }

                if (date.toDateString() === selectedDate.toDateString()) {
                    dayElement.className += ' selected';
                }

                // Check if this date has bookings
                const hasBookings = bookings.some(booking => 
                    new Date(booking.date).toDateString() === date.toDateString()
                );
                if (hasBookings && date.getMonth() === currentDate.getMonth()) {
                    dayElement.className += ' has-booking';
                }

                dayElement.textContent = date.getDate();
                dayElement.addEventListener('click', () => selectDate(date));
                calendar.appendChild(dayElement);
            }
        }

        function selectDate(date) {
            if (date < new Date().setHours(0,0,0,0)) return; // Prevent selecting past dates
            
            selectedDate = new Date(date);
            generateCalendar();
            updateRoomAvailability();
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar();
        }

        function generateRoomList() {
            const roomList = document.getElementById('roomList');
            roomList.innerHTML = '';

            rooms.forEach(room => {
                const roomCard = document.createElement('div');
                roomCard.className = 'bg-gradient-to-br from-white to-gray-50 rounded-lg p-6 border border-gray-200 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1';
                roomCard.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">${room.name}</h3>
                        <span id="status-${room.id}" class="px-3 py-1 rounded-full text-sm font-medium"></span>
                    </div>
                    <div class="text-gray-600 mb-4">
                        <p>üìç ${room.location}</p>
                        <p>üë• ‡∏à‡∏∏‡πÑ‡∏î‡πâ ${room.capacity} ‡∏Ñ‡∏ô</p>
                    </div>
                    <button id="btn-${room.id}" onclick="selectRoom('${room.id}')" 
                            class="w-full py-3 rounded-lg font-medium transition-all duration-300 transform hover:scale-105">
                        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ
                    </button>
                `;
                roomList.appendChild(roomCard);
            });

            updateRoomAvailability();
        }

        function updateRoomAvailability() {
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            
            if (!startTime || !endTime || startTime >= endTime) {
                rooms.forEach(room => {
                    const statusElement = document.getElementById(`status-${room.id}`);
                    const buttonElement = document.getElementById(`btn-${room.id}`);
                    statusElement.textContent = '‚ö†Ô∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤';
                    statusElement.className = 'px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800';
                    buttonElement.disabled = true;
                    buttonElement.className = 'w-full py-3 rounded-lg font-medium bg-gray-300 text-gray-500 cursor-not-allowed';
                });
                return;
            }

            rooms.forEach(room => {
                const isAvailable = checkRoomAvailability(room.id, selectedDate, startTime, endTime);
                const statusElement = document.getElementById(`status-${room.id}`);
                const buttonElement = document.getElementById(`btn-${room.id}`);

                if (isAvailable) {
                    statusElement.textContent = '‚úÖ ‡∏ß‡πà‡∏≤‡∏á';
                    statusElement.className = 'px-3 py-1 rounded-full text-sm font-medium status-available text-white';
                    buttonElement.disabled = false;
                    buttonElement.className = 'w-full py-3 rounded-lg font-medium btn-primary text-white hover:shadow-lg transition-all duration-300 transform hover:scale-105';
                } else {
                    statusElement.textContent = '‚ùå ‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß';
                    statusElement.className = 'px-3 py-1 rounded-full text-sm font-medium status-booked text-white';
                    buttonElement.disabled = true;
                    buttonElement.className = 'w-full py-3 rounded-lg font-medium bg-gray-300 text-gray-500 cursor-not-allowed';
                }
            });
        }

        function checkRoomAvailability(roomId, date, startTime, endTime) {
            const dateStr = date.toISOString().split('T')[0];
            return !bookings.some(booking => 
                booking.roomId === roomId && 
                booking.date === dateStr &&
                booking.status === 'confirmed' &&
                ((startTime >= booking.startTime && startTime < booking.endTime) ||
                 (endTime > booking.startTime && endTime <= booking.endTime) ||
                 (startTime <= booking.startTime && endTime >= booking.endTime))
            );
        }

        function selectRoom(roomId) {
            const room = rooms.find(r => r.id === roomId);
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;

            if (!startTime || !endTime || startTime >= endTime) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                return;
            }

            document.getElementById('selectedRoom').value = room.name;
            document.getElementById('selectedDateTime').value = 
                `${selectedDate.toLocaleDateString('th-TH')} ‡πÄ‡∏ß‡∏•‡∏≤ ${startTime} - ${endTime}`;
            
            document.getElementById('bookingModal').classList.remove('hidden');
            document.getElementById('bookingModal').classList.add('flex');
        }

        function closeBookingModal() {
            document.getElementById('bookingModal').classList.add('hidden');
            document.getElementById('bookingModal').classList.remove('flex');
            document.getElementById('bookingForm').reset();
        }

        function submitBooking(event) {
            event.preventDefault();
            
            const roomName = document.getElementById('selectedRoom').value;
            const room = rooms.find(r => r.name === roomName);
            const department = document.getElementById('department').value;
            const purpose = document.getElementById('purpose').value;
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;

            const booking = {
                id: Date.now(),
                roomId: room.id,
                roomName: room.name,
                date: selectedDate.toISOString().split('T')[0],
                startTime: startTime,
                endTime: endTime,
                department: department,
                purpose: purpose,
                status: 'confirmed',
                createdAt: new Date().toISOString()
            };

            bookings.push(booking);
            localStorage.setItem('meetingBookings', JSON.stringify(bookings));

            alert('‚úÖ ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
            closeBookingModal();
            updateRoomAvailability();
            generateCalendar();
            updateMyBookings();
            updateStatistics();
        }

        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });

            // Show selected page
            document.getElementById(pageName + 'Page').classList.remove('hidden');

            // Update specific page content
            if (pageName === 'calendar') {
                generateFullCalendar();
            } else if (pageName === 'statistics') {
                updateStatistics();
            } else if (pageName === 'myBookings') {
                updateMyBookings();
            }
        }

        function updateMyBookings() {
            const myBookingsList = document.getElementById('myBookingsList');
            const roomFilter = document.getElementById('roomFilter').value;
            const dateFilter = document.getElementById('dateFilter').value;

            let filteredBookings = bookings.filter(booking => booking.status === 'confirmed');

            if (roomFilter) {
                filteredBookings = filteredBookings.filter(booking => booking.roomId === roomFilter);
            }

            if (dateFilter) {
                filteredBookings = filteredBookings.filter(booking => booking.date === dateFilter);
            }

            if (filteredBookings.length === 0) {
                myBookingsList.innerHTML = '<p class="text-center text-gray-500 py-8">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</p>';
                return;
            }

            myBookingsList.innerHTML = filteredBookings.map(booking => `
                <div class="bg-gradient-to-r from-cyan-50 to-green-50 rounded-lg p-6 mb-4 border border-cyan-200">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-800 mb-2">${booking.roomName}</h3>
                            <div class="text-gray-600 space-y-1">
                                <p>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${new Date(booking.date).toLocaleDateString('th-TH')}</p>
                                <p>‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤: ${booking.startTime} - ${booking.endTime}</p>
                                <p>üè¢ ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô: ${booking.department}</p>
                                <p>üìù ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ${booking.purpose}</p>
                            </div>
                        </div>
                        <div class="flex flex-col gap-2">
                            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium">
                                ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß
                            </span>
                            <button onclick="cancelBooking(${booking.id})" 
                                    class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-all duration-300">
                                üóëÔ∏è ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function populateRoomFilter() {
            const roomFilter = document.getElementById('roomFilter');
            roomFilter.innerHTML = '<option value="">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>';
            rooms.forEach(room => {
                const option = new Option(room.name, room.id);
                roomFilter.add(option);
            });
        }

        function filterMyBookings() {
            updateMyBookings();
        }

        function cancelBooking(bookingId) {
            currentBookingToCancel = bookingId;
            document.getElementById('cancelModal').classList.remove('hidden');
            document.getElementById('cancelModal').classList.add('flex');
        }

        function closeCancelModal() {
            document.getElementById('cancelModal').classList.add('hidden');
            document.getElementById('cancelModal').classList.remove('flex');
            document.getElementById('cancelCode').value = '';
            currentBookingToCancel = null;
        }

        function confirmCancel() {
            const code = document.getElementById('cancelCode').value;
            if (code !== '1234') {
                alert('‚ùå ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                return;
            }

            const bookingIndex = bookings.findIndex(b => b.id === currentBookingToCancel);
            if (bookingIndex !== -1) {
                bookings[bookingIndex].status = 'cancelled';
                localStorage.setItem('meetingBookings', JSON.stringify(bookings));
                alert('‚úÖ ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                closeCancelModal();
                updateMyBookings();
                updateRoomAvailability();
                generateCalendar();
                updateStatistics();
            }
        }

        function generateFullCalendar() {
            const fullCalendar = document.getElementById('fullCalendar');
            const monthNames = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                              '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];
            const dayNames = ['‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå', '‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', '‡∏û‡∏∏‡∏ò', '‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ', '‡∏®‡∏∏‡∏Å‡∏£‡πå', '‡πÄ‡∏™‡∏≤‡∏£‡πå'];

            document.getElementById('calendarCurrentMonth').textContent = 
                `${monthNames[calendarDate.getMonth()]} ${calendarDate.getFullYear() + 543}`;

            fullCalendar.innerHTML = '';

            // Add day headers
            dayNames.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'text-center font-semibold text-gray-600 py-3 bg-gray-100 rounded-lg';
                dayHeader.textContent = day;
                fullCalendar.appendChild(dayHeader);
            });

            const firstDay = new Date(calendarDate.getFullYear(), calendarDate.getMonth(), 1);
            const lastDay = new Date(calendarDate.getFullYear(), calendarDate.getMonth() + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);

                const dayElement = document.createElement('div');
                dayElement.className = 'min-h-24 p-2 border border-gray-200 rounded-lg';
                
                if (date.getMonth() !== calendarDate.getMonth()) {
                    dayElement.className += ' bg-gray-50 text-gray-400';
                } else {
                    dayElement.className += ' bg-white';
                }

                const dayBookings = bookings.filter(booking => 
                    new Date(booking.date).toDateString() === date.toDateString() && 
                    booking.status === 'confirmed'
                );

                dayElement.innerHTML = `
                    <div class="font-semibold text-sm mb-1">${date.getDate()}</div>
                    ${dayBookings.map(booking => `
                        <div class="text-xs bg-cyan-100 text-cyan-800 rounded px-2 py-1 mb-1 truncate" title="${booking.roomName} - ${booking.startTime}">
                            ${booking.roomName.substring(0, 10)}...
                        </div>
                    `).join('')}
                `;

                fullCalendar.appendChild(dayElement);
            }
        }

        function previousCalendarMonth() {
            calendarDate.setMonth(calendarDate.getMonth() - 1);
            generateFullCalendar();
        }

        function nextCalendarMonth() {
            calendarDate.setMonth(calendarDate.getMonth() + 1);
            generateFullCalendar();
        }

        function updateStatistics() {
            const confirmedBookings = bookings.filter(b => b.status === 'confirmed');
            const totalBookings = confirmedBookings.length;
            
            // Room usage statistics
            const roomUsage = {};
            rooms.forEach(room => {
                roomUsage[room.name] = confirmedBookings.filter(b => b.roomId === room.id).length;
            });

            // Time slot statistics
            const timeSlots = {};
            confirmedBookings.forEach(booking => {
                const hour = parseInt(booking.startTime.split(':')[0]);
                const timeRange = `${hour}:00-${hour + 1}:00`;
                timeSlots[timeRange] = (timeSlots[timeRange] || 0) + 1;
            });

            // Most popular room
            const mostPopularRoom = Object.keys(roomUsage).reduce((a, b) => 
                roomUsage[a] > roomUsage[b] ? a : b, Object.keys(roomUsage)[0] || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'
            );

            // Most popular time
            const mostPopularTime = Object.keys(timeSlots).reduce((a, b) => 
                timeSlots[a] > timeSlots[b] ? a : b, Object.keys(timeSlots)[0] || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'
            );

            document.getElementById('statisticsContent').innerHTML = `
                <div class="space-y-6">
                    <div class="bg-gradient-to-r from-cyan-50 to-blue-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                        <p class="text-2xl font-bold text-cyan-600">${totalBookings} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                        <p class="text-gray-600">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                    </div>
                    
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">üèÜ ‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
                        <p class="text-xl font-bold text-green-600">${mostPopularRoom}</p>
                        <p class="text-gray-600">${roomUsage[mostPopularRoom] || 0} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                    </div>
                    
                    <div class="bg-gradient-to-r from-orange-50 to-yellow-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
                        <p class="text-xl font-bold text-orange-600">${mostPopularTime}</p>
                        <p class="text-gray-600">${timeSlots[mostPopularTime] || 0} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                    </div>
                </div>
            `;

            // Generate chart
            const chartContent = document.getElementById('chartContent');
            chartContent.innerHTML = `
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-800">‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á</h3>
                    ${Object.entries(roomUsage).map(([room, count]) => `
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-gray-600 flex-1">${room}</span>
                            <div class="flex-1 mx-4">
                                <div class="bg-gray-200 rounded-full h-4">
                                    <div class="bg-gradient-to-r from-cyan-400 to-blue-500 h-4 rounded-full" 
                                         style="width: ${totalBookings > 0 ? (count / Math.max(...Object.values(roomUsage))) * 100 : 0}%"></div>
                                </div>
                            </div>
                            <span class="text-sm font-semibold text-gray-800 w-8">${count}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'984365cc70e25805',t:'MTc1ODcyODYwOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
