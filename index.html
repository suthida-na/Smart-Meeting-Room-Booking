<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Meeting Room Booking - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Sarabun', sans-serif;
            background: linear-gradient(135deg, #e0f2fe 0%, #f1f8e9 100%);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #00bcd4 0%, #4caf50 100%);
        }
        
        .room-card {
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .room-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 188, 212, 0.15);
        }
        
        .room-available {
            border-color: #4caf50;
            background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%);
        }
        
        .room-booked {
            border-color: #f44336;
            background: linear-gradient(135deg, #ffebee 0%, #fce4ec 100%);
        }
        
        .calendar-day {
            transition: all 0.2s ease;
        }
        
        .calendar-day:hover {
            background-color: #b2ebf2;
        }
        
        .calendar-day.selected {
            background: linear-gradient(135deg, #00bcd4 0%, #4caf50 100%);
            color: white;
        }
        
        .time-slot {
            transition: all 0.2s ease;
        }
        
        .time-slot:hover {
            background-color: #b2ebf2;
        }
        
        .time-slot.selected {
            background: linear-gradient(135deg, #00bcd4 0%, #4caf50 100%);
            color: white;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <h1 class="text-3xl font-bold text-center">üè¢ Smart Meeting Room Booking</h1>
            <p class="text-center text-lg mt-2 opacity-90">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</p>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-md sticky top-0 z-40">
        <div class="container mx-auto px-4">
            <div class="flex justify-center space-x-1 py-3">
                <button onclick="showPage('booking')" class="nav-btn px-6 py-2 rounded-lg font-medium transition-all duration-200 bg-cyan-500 text-white">
                    üìÖ ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
                </button>
                <button onclick="showPage('myBookings')" class="nav-btn px-6 py-2 rounded-lg font-medium transition-all duration-200 text-cyan-600 hover:bg-cyan-50">
                    üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô
                </button>
                <button onclick="showPage('allBookings')" class="nav-btn px-6 py-2 rounded-lg font-medium transition-all duration-200 text-cyan-600 hover:bg-cyan-50">
                    üìä ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
                </button>
                <button onclick="showPage('statistics')" class="nav-btn px-6 py-2 rounded-lg font-medium transition-all duration-200 text-cyan-600 hover:bg-cyan-50">
                    üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                </button>
            </div>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        <!-- Booking Page -->
        <div id="bookingPage" class="page">
            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Calendar Section -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                            üìÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
                        </h3>
                        <div class="calendar-container">
                            <div class="flex justify-between items-center mb-4">
                                <button onclick="changeMonth(-1)" class="p-2 rounded-lg bg-cyan-100 text-cyan-600 hover:bg-cyan-200">
                                    ‚Üê
                                </button>
                                <h4 id="currentMonth" class="font-semibold text-lg"></h4>
                                <button onclick="changeMonth(1)" class="p-2 rounded-lg bg-cyan-100 text-cyan-600 hover:bg-cyan-200">
                                    ‚Üí
                                </button>
                            </div>
                            <div class="grid grid-cols-7 gap-1 mb-2">
                                <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏≠‡∏≤</div>
                                <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏à</div>
                                <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏≠</div>
                                <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏û</div>
                                <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏û‡∏§</div>
                                <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏®</div>
                                <div class="text-center text-sm font-medium text-gray-600 py-2">‡∏™</div>
                            </div>
                            <div id="calendarDays" class="grid grid-cols-7 gap-1"></div>
                        </div>
                        
                        <!-- Time Selection -->
                        <div class="mt-6">
                            <h4 class="font-semibold text-gray-800 mb-3">‚è∞ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</h4>
                            <div class="grid grid-cols-2 gap-2">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°</label>
                                    <select id="startTime" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                                        <!-- Time options will be populated by JavaScript -->
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
                                    <select id="endTime" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                                        <!-- Time options will be populated by JavaScript -->
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Room Selection -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                            üè¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
                        </h3>
                        <div id="roomList" class="grid md:grid-cols-2 gap-4">
                            <!-- Rooms will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- My Bookings Page -->
        <div id="myBookingsPage" class="page hidden">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6 flex items-center">
                    üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô
                </h3>
                
                <!-- Filters -->
                <div class="grid md:grid-cols-3 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á</label>
                        <select id="roomFilter" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500">
                            <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                        <input type="date" id="dateFilter" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500">
                    </div>
                    <div class="flex items-end">
                        <button onclick="applyFilters()" class="w-full bg-cyan-500 text-white px-4 py-2 rounded-lg hover:bg-cyan-600 transition-colors">
                            üîç ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                    </div>
                </div>
                
                <div id="myBookingsList" class="space-y-4">
                    <!-- My bookings will be populated here -->
                </div>
            </div>
        </div>

        <!-- All Bookings Calendar Page -->
        <div id="allBookingsPage" class="page hidden">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6 flex items-center">
                    üìä ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </h3>
                
                <!-- Room Filter -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏π</label>
                    <select id="calendarRoomFilter" onchange="updateCalendarView()" class="p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500">
                        <option value="">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>
                    </select>
                </div>
                
                <!-- Calendar View -->
                <div class="calendar-view">
                    <div class="flex justify-between items-center mb-4">
                        <button onclick="changeCalendarMonth(-1)" class="px-4 py-2 bg-cyan-100 text-cyan-600 rounded-lg hover:bg-cyan-200">
                            ‚Üê ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô
                        </button>
                        <h4 id="calendarCurrentMonth" class="text-xl font-semibold"></h4>
                        <button onclick="changeCalendarMonth(1)" class="px-4 py-2 bg-cyan-100 text-cyan-600 rounded-lg hover:bg-cyan-200">
                            ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-2">
                        <div class="text-center font-semibold text-gray-700 py-3 bg-gray-100 rounded">‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</div>
                        <div class="text-center font-semibold text-gray-700 py-3 bg-gray-100 rounded">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</div>
                        <div class="text-center font-semibold text-gray-700 py-3 bg-gray-100 rounded">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</div>
                        <div class="text-center font-semibold text-gray-700 py-3 bg-gray-100 rounded">‡∏û‡∏∏‡∏ò</div>
                        <div class="text-center font-semibold text-gray-700 py-3 bg-gray-100 rounded">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</div>
                        <div class="text-center font-semibold text-gray-700 py-3 bg-gray-100 rounded">‡∏®‡∏∏‡∏Å‡∏£‡πå</div>
                        <div class="text-center font-semibold text-gray-700 py-3 bg-gray-100 rounded">‡πÄ‡∏™‡∏≤‡∏£‡πå</div>
                    </div>
                    <div id="calendarGrid" class="grid grid-cols-7 gap-2 mt-2">
                        <!-- Calendar days will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Page -->
        <div id="statisticsPage" class="page hidden">
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        üìä ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                    </h4>
                    <div class="text-3xl font-bold text-cyan-600" id="totalBookings">0</div>
                    <p class="text-gray-600 mt-2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        üèÜ ‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
                    </h4>
                    <div class="text-lg font-semibold text-green-600" id="mostUsedRoom">-</div>
                    <p class="text-gray-600 mt-2" id="mostUsedRoomCount">0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        ‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
                    </h4>
                    <div class="text-lg font-semibold text-blue-600" id="peakTime">-</div>
                    <p class="text-gray-600 mt-2" id="peakTimeCount">0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                </div>
                
                <div class="md:col-span-2 lg:col-span-3 bg-white rounded-xl shadow-lg p-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á</h4>
                    <div id="roomStats" class="space-y-3">
                        <!-- Room statistics will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Booking Modal -->
    <div id="bookingModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-2xl p-8 m-4 max-w-md w-full">
            <h3 class="text-xl font-semibold text-gray-800 mb-6">üìù ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h3>
            
            <form id="bookingForm" onsubmit="submitBooking(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</label>
                        <input type="text" id="selectedRoom" readonly class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                        <input type="text" id="selectedDate" readonly class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏ß‡∏•‡∏≤</label>
                        <input type="text" id="selectedTime" readonly class="w-full p-3 bg-gray-100 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô *</label>
                        <input type="text" id="department" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô *</label>
                        <textarea id="purpose" required rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"></textarea>
                    </div>
                </div>
                
                <div class="flex space-x-3 mt-6">
                    <button type="button" onclick="closeBookingModal()" class="flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button type="submit" class="flex-1 px-4 py-3 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 transition-colors">
                        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Cancel Booking Modal -->
    <div id="cancelModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-2xl p-8 m-4 max-w-md w-full">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</h3>
            <p class="text-gray-600 mb-4">‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£</p>
            <p class="text-sm text-gray-500 mb-4">‡∏£‡∏´‡∏±‡∏™‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á: <span class="font-mono bg-gray-100 px-2 py-1 rounded">1234</span></p>
            
            <div class="flex space-x-3">
                <button onclick="closeCancelModal()" class="flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                    ‡∏õ‡∏¥‡∏î
                </button>
                <button onclick="confirmCancel()" class="flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentDate = new Date();
        let selectedDates = [];
        let selectedStartTime = '';
        let selectedEndTime = '';
        let selectedRoomForBooking = '';
        let bookings = JSON.parse(localStorage.getItem('meetingRoomBookings')) || [];
        let currentBookingToCancel = null;
        let calendarCurrentDate = new Date();

        // Room data
        const rooms = [
            { id: 'usr', name: '‡∏´‡πâ‡∏≠‡∏áUSR(1-101)', capacity: 70, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 1 ‡∏ä‡∏±‡πâ‡∏ô 1' },
            { id: 'seminar', name: '‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏±‡∏°‡∏°‡∏ô‡∏≤', capacity: 80, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 3 ‡∏ä‡∏±‡πâ‡∏ô 1' },
            { id: 'pukya1', name: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏û‡∏∏‡∏Ñ‡∏¢‡∏≤‡∏†‡∏£‡∏ì‡πå 1', capacity: 360, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 3 ‡∏ä‡∏±‡πâ‡∏ô 1' },
            { id: 'pukya2', name: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏û‡∏∏‡∏Ñ‡∏¢‡∏≤‡∏†‡∏£‡∏ì‡πå 2 (3-206)', capacity: 120, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 3 ‡∏ä‡∏±‡πâ‡∏ô 2' },
            { id: 'executive', name: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ 3-202', capacity: 40, location: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ 3 ‡∏ä‡∏±‡πâ‡∏ô 2' }
        ];

        // Initialize the application
        function init() {
            generateTimeOptions();
            generateCalendar();
            updateRoomList();
            updateMyBookings();
            updateStatistics();
            populateRoomFilters();
            updateCalendarView();
            
            // Set default time
            document.getElementById('startTime').value = '09:00';
            document.getElementById('endTime').value = '10:00';
        }

        // Generate time options
        function generateTimeOptions() {
            const startSelect = document.getElementById('startTime');
            const endSelect = document.getElementById('endTime');
            
            startSelect.innerHTML = '';
            endSelect.innerHTML = '';
            
            for (let hour = 9; hour <= 20; hour++) {
                for (let minute of [0, 30]) {
                    if (hour === 20 && minute === 30) continue;
                    
                    const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    
                    startSelect.innerHTML += `<option value="${timeString}">${timeString}</option>`;
                    endSelect.innerHTML += `<option value="${timeString}">${timeString}</option>`;
                }
            }
        }

        // Generate calendar
        function generateCalendar() {
            const monthNames = [
                '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
            ];
            
            document.getElementById('currentMonth').textContent = 
                `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear() + 543}`;
            
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';
            
            const today = new Date();
            
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day text-center p-2 rounded-lg cursor-pointer';
                dayElement.textContent = date.getDate();
                
                if (date.getMonth() !== currentDate.getMonth()) {
                    dayElement.className += ' text-gray-400';
                } else if (date < today.setHours(0,0,0,0)) {
                    dayElement.className += ' text-gray-400 cursor-not-allowed';
                } else {
                    dayElement.onclick = () => toggleDateSelection(date);
                    
                    if (selectedDates.some(d => d.toDateString() === date.toDateString())) {
                        dayElement.className += ' selected';
                    }
                    
                    if (date.toDateString() === today.toDateString()) {
                        dayElement.className += ' bg-yellow-100 border border-yellow-300';
                    }
                }
                
                calendarDays.appendChild(dayElement);
            }
        }

        // Toggle date selection
        function toggleDateSelection(date) {
            const today = new Date();
            if (date < today.setHours(0,0,0,0)) return;
            
            const existingIndex = selectedDates.findIndex(d => d.toDateString() === date.toDateString());
            
            if (existingIndex > -1) {
                selectedDates.splice(existingIndex, 1);
            } else {
                selectedDates.push(new Date(date));
            }
            
            generateCalendar();
            updateRoomList();
        }

        // Change month
        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            generateCalendar();
        }

        // Update room list
        function updateRoomList() {
            const roomList = document.getElementById('roomList');
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            
            roomList.innerHTML = '';
            
            rooms.forEach(room => {
                const roomCard = document.createElement('div');
                roomCard.className = 'room-card p-4 rounded-lg cursor-pointer';
                
                let isAvailable = true;
                
                // Check availability for selected dates and time
                if (selectedDates.length > 0 && startTime && endTime) {
                    for (const date of selectedDates) {
                        const dateStr = date.toISOString().split('T')[0];
                        const conflict = bookings.some(booking => 
                            booking.roomId === room.id && 
                            booking.date === dateStr &&
                            booking.status === 'confirmed' &&
                            timeOverlap(startTime, endTime, booking.startTime, booking.endTime)
                        );
                        
                        if (conflict) {
                            isAvailable = false;
                            break;
                        }
                    }
                }
                
                roomCard.className += isAvailable ? ' room-available' : ' room-booked';
                
                roomCard.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <h4 class="font-semibold text-lg text-gray-800">${room.name}</h4>
                        <span class="text-sm ${isAvailable ? 'text-green-600' : 'text-red-600'}">
                            ${isAvailable ? '‚úÖ ‡∏ß‡πà‡∏≤‡∏á' : '‚ùå ‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß'}
                        </span>
                    </div>
                    <p class="text-gray-600 text-sm mb-2">üìç ${room.location}</p>
                    <p class="text-gray-600 text-sm mb-3">üë• ‡∏à‡∏∏‡πÑ‡∏î‡πâ ${room.capacity} ‡∏Ñ‡∏ô</p>
                    ${isAvailable ? '<p class="text-cyan-600 text-sm font-medium">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≠‡∏á</p>' : ''}
                `;
                
                if (isAvailable && selectedDates.length > 0 && startTime && endTime) {
                    roomCard.onclick = () => openBookingModal(room);
                }
                
                roomList.appendChild(roomCard);
            });
        }

        // Check time overlap
        function timeOverlap(start1, end1, start2, end2) {
            return start1 < end2 && end1 > start2;
        }

        // Open booking modal
        function openBookingModal(room) {
            selectedRoomForBooking = room;
            
            document.getElementById('selectedRoom').value = room.name;
            document.getElementById('selectedDate').value = selectedDates.map(d => 
                d.toLocaleDateString('th-TH')).join(', ');
            document.getElementById('selectedTime').value = 
                `${document.getElementById('startTime').value} - ${document.getElementById('endTime').value}`;
            
            document.getElementById('bookingModal').classList.remove('hidden');
            document.getElementById('bookingModal').classList.add('flex');
        }

        // Close booking modal
        function closeBookingModal() {
            document.getElementById('bookingModal').classList.add('hidden');
            document.getElementById('bookingModal').classList.remove('flex');
            document.getElementById('bookingForm').reset();
        }

        // Submit booking
        function submitBooking(event) {
            event.preventDefault();
            
            const department = document.getElementById('department').value;
            const purpose = document.getElementById('purpose').value;
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            
            // Create bookings for all selected dates
            selectedDates.forEach(date => {
                const booking = {
                    id: Date.now() + Math.random(),
                    roomId: selectedRoomForBooking.id,
                    roomName: selectedRoomForBooking.name,
                    date: date.toISOString().split('T')[0],
                    startTime: startTime,
                    endTime: endTime,
                    department: department,
                    purpose: purpose,
                    status: 'confirmed',
                    createdAt: new Date().toISOString()
                };
                
                bookings.push(booking);
            });
            
            // Save to localStorage
            localStorage.setItem('meetingRoomBookings', JSON.stringify(bookings));
            
            // Save to Google Sheets (simulated)
            saveToGoogleSheets();
            
            closeBookingModal();
            updateRoomList();
            updateMyBookings();
            updateStatistics();
            
            alert('‚úÖ ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
        }

        // Simulate saving to Google Sheets
        function saveToGoogleSheets() {
            // In a real implementation, this would make an API call to Google Sheets
            console.log('Saving to Google Sheets:', bookings[bookings.length - 1]);
        }

        // Show page
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            
            // Show selected page
            document.getElementById(pageId + 'Page').classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.className = 'nav-btn px-6 py-2 rounded-lg font-medium transition-all duration-200 text-cyan-600 hover:bg-cyan-50';
            });
            
            event.target.className = 'nav-btn px-6 py-2 rounded-lg font-medium transition-all duration-200 bg-cyan-500 text-white';
            
            // Update page-specific content
            if (pageId === 'myBookings') {
                updateMyBookings();
            } else if (pageId === 'statistics') {
                updateStatistics();
            } else if (pageId === 'allBookings') {
                updateCalendarView();
            }
        }

        // Update my bookings
        function updateMyBookings() {
            const myBookingsList = document.getElementById('myBookingsList');
            const userBookings = bookings.filter(booking => booking.status === 'confirmed');
            
            if (userBookings.length === 0) {
                myBookingsList.innerHTML = '<p class="text-gray-500 text-center py-8">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</p>';
                return;
            }
            
            myBookingsList.innerHTML = userBookings.map(booking => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="font-semibold text-lg text-gray-800">${booking.roomName}</h4>
                            <p class="text-gray-600 mt-1">üìÖ ${new Date(booking.date).toLocaleDateString('th-TH')}</p>
                            <p class="text-gray-600">‚è∞ ${booking.startTime} - ${booking.endTime}</p>
                            <p class="text-gray-600">üè¢ ${booking.department}</p>
                            <p class="text-gray-600 mt-2">${booking.purpose}</p>
                        </div>
                        <div class="flex flex-col space-y-2">
                            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">
                                ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß
                            </span>
                            <button onclick="openCancelModal('${booking.id}')" 
                                    class="px-3 py-1 bg-red-100 text-red-600 rounded-lg text-sm hover:bg-red-200 transition-colors">
                                ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Populate room filters
        function populateRoomFilters() {
            const roomFilter = document.getElementById('roomFilter');
            const calendarRoomFilter = document.getElementById('calendarRoomFilter');
            
            rooms.forEach(room => {
                const option = `<option value="${room.id}">${room.name}</option>`;
                roomFilter.innerHTML += option;
                calendarRoomFilter.innerHTML += option;
            });
        }

        // Apply filters
        function applyFilters() {
            const roomFilter = document.getElementById('roomFilter').value;
            const dateFilter = document.getElementById('dateFilter').value;
            
            let filteredBookings = bookings.filter(booking => booking.status === 'confirmed');
            
            if (roomFilter) {
                filteredBookings = filteredBookings.filter(booking => booking.roomId === roomFilter);
            }
            
            if (dateFilter) {
                filteredBookings = filteredBookings.filter(booking => booking.date === dateFilter);
            }
            
            const myBookingsList = document.getElementById('myBookingsList');
            
            if (filteredBookings.length === 0) {
                myBookingsList.innerHTML = '<p class="text-gray-500 text-center py-8">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</p>';
                return;
            }
            
            myBookingsList.innerHTML = filteredBookings.map(booking => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="font-semibold text-lg text-gray-800">${booking.roomName}</h4>
                            <p class="text-gray-600 mt-1">üìÖ ${new Date(booking.date).toLocaleDateString('th-TH')}</p>
                            <p class="text-gray-600">‚è∞ ${booking.startTime} - ${booking.endTime}</p>
                            <p class="text-gray-600">üè¢ ${booking.department}</p>
                            <p class="text-gray-600 mt-2">${booking.purpose}</p>
                        </div>
                        <div class="flex flex-col space-y-2">
                            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">
                                ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß
                            </span>
                            <button onclick="openCancelModal('${booking.id}')" 
                                    class="px-3 py-1 bg-red-100 text-red-600 rounded-lg text-sm hover:bg-red-200 transition-colors">
                                ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Open cancel modal
        function openCancelModal(bookingId) {
            currentBookingToCancel = bookingId;
            document.getElementById('cancelModal').classList.remove('hidden');
            document.getElementById('cancelModal').classList.add('flex');
        }

        // Close cancel modal
        function closeCancelModal() {
            document.getElementById('cancelModal').classList.add('hidden');
            document.getElementById('cancelModal').classList.remove('flex');
            currentBookingToCancel = null;
        }

        // Confirm cancel
        function confirmCancel() {
            if (currentBookingToCancel) {
                const bookingIndex = bookings.findIndex(b => b.id == currentBookingToCancel);
                if (bookingIndex > -1) {
                    bookings[bookingIndex].status = 'cancelled';
                    localStorage.setItem('meetingRoomBookings', JSON.stringify(bookings));
                    
                    updateMyBookings();
                    updateRoomList();
                    updateStatistics();
                    
                    alert('‚úÖ ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                }
            }
            closeCancelModal();
        }

        // Update statistics
        function updateStatistics() {
            const confirmedBookings = bookings.filter(b => b.status === 'confirmed');
            
            // Total bookings
            document.getElementById('totalBookings').textContent = confirmedBookings.length;
            
            // Most used room
            const roomUsage = {};
            confirmedBookings.forEach(booking => {
                roomUsage[booking.roomId] = (roomUsage[booking.roomId] || 0) + 1;
            });
            
            let mostUsedRoom = '';
            let maxUsage = 0;
            Object.entries(roomUsage).forEach(([roomId, count]) => {
                if (count > maxUsage) {
                    maxUsage = count;
                    mostUsedRoom = rooms.find(r => r.id === roomId)?.name || roomId;
                }
            });
            
            document.getElementById('mostUsedRoom').textContent = mostUsedRoom || '-';
            document.getElementById('mostUsedRoomCount').textContent = `${maxUsage} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á`;
            
            // Peak time
            const timeUsage = {};
            confirmedBookings.forEach(booking => {
                const timeSlot = booking.startTime;
                timeUsage[timeSlot] = (timeUsage[timeSlot] || 0) + 1;
            });
            
            let peakTime = '';
            let maxTimeUsage = 0;
            Object.entries(timeUsage).forEach(([time, count]) => {
                if (count > maxTimeUsage) {
                    maxTimeUsage = count;
                    peakTime = time;
                }
            });
            
            document.getElementById('peakTime').textContent = peakTime || '-';
            document.getElementById('peakTimeCount').textContent = `${maxTimeUsage} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á`;
            
            // Room statistics
            const roomStats = document.getElementById('roomStats');
            roomStats.innerHTML = rooms.map(room => {
                const usage = roomUsage[room.id] || 0;
                const percentage = confirmedBookings.length > 0 ? (usage / confirmedBookings.length * 100).toFixed(1) : 0;
                
                return `
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <span class="font-medium">${room.name}</span>
                        <div class="flex items-center space-x-3">
                            <span class="text-sm text-gray-600">${usage} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á (${percentage}%)</span>
                            <div class="w-20 bg-gray-200 rounded-full h-2">
                                <div class="bg-cyan-500 h-2 rounded-full" style="width: ${percentage}%"></div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Calendar view functions
        function updateCalendarView() {
            const monthNames = [
                '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
            ];
            
            document.getElementById('calendarCurrentMonth').textContent = 
                `${monthNames[calendarCurrentDate.getMonth()]} ${calendarCurrentDate.getFullYear() + 543}`;
            
            const firstDay = new Date(calendarCurrentDate.getFullYear(), calendarCurrentDate.getMonth(), 1);
            const lastDay = new Date(calendarCurrentDate.getFullYear(), calendarCurrentDate.getMonth() + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            const calendarGrid = document.getElementById('calendarGrid');
            calendarGrid.innerHTML = '';
            
            const selectedRoomFilter = document.getElementById('calendarRoomFilter').value;
            
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'min-h-24 p-2 border border-gray-200 rounded-lg';
                
                if (date.getMonth() !== calendarCurrentDate.getMonth()) {
                    dayElement.className += ' bg-gray-50';
                }
                
                const dateStr = date.toISOString().split('T')[0];
                const dayBookings = bookings.filter(booking => 
                    booking.date === dateStr && 
                    booking.status === 'confirmed' &&
                    (!selectedRoomFilter || booking.roomId === selectedRoomFilter)
                );
                
                dayElement.innerHTML = `
                    <div class="font-semibold text-sm mb-1 ${date.getMonth() !== calendarCurrentDate.getMonth() ? 'text-gray-400' : ''}">${date.getDate()}</div>
                    ${dayBookings.map(booking => `
                        <div class="text-xs bg-cyan-100 text-cyan-800 p-1 rounded mb-1 truncate" title="${booking.purpose}">
                            ${booking.startTime} ${booking.roomName}
                        </div>
                    `).join('')}
                `;
                
                calendarGrid.appendChild(dayElement);
            }
        }

        function changeCalendarMonth(direction) {
            calendarCurrentDate.setMonth(calendarCurrentDate.getMonth() + direction);
            updateCalendarView();
        }

        // Event listeners
        document.getElementById('startTime').addEventListener('change', updateRoomList);
        document.getElementById('endTime').addEventListener('change', updateRoomList);

        // Initialize the application when the page loads
        init();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9843838cf59845b8',t:'MTc1ODcyOTgyNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
